from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.types import *
from prophecy.utils import *
from prophecy.libs import typed_lit
from pl_farmers_market.config.ConfigStore import *
from pl_farmers_market.udfs.UDFs import *

def ds_zipcode_agi(spark: SparkSession) -> DataFrame:
    return spark.read\
        .schema(
          StructType([
            StructField("STATEFIPS", IntegerType(), True), StructField("STATE", StringType(), True), StructField("zipcode", IntegerType(), True), StructField("agi_stub", IntegerType(), True), StructField("N1", DecimalType(20, 2), True), StructField("MARS1", DecimalType(20, 2), True), StructField("MARS2", DecimalType(20, 2), True), StructField("MARS4", DecimalType(20, 2), True), StructField("PREP", DecimalType(20, 2), True), StructField("N2", DecimalType(20, 2), True), StructField("NUMDEP", DecimalType(20, 2), True), StructField("A00100", DecimalType(20, 2), True), StructField("N02650", DecimalType(20, 2), True), StructField("A02650", DecimalType(20, 2), True), StructField("N00200", DecimalType(20, 2), True), StructField("A00200", DecimalType(20, 2), True), StructField("N00300", DecimalType(20, 2), True), StructField("A00300", DecimalType(20, 2), True), StructField("N00600", DecimalType(20, 2), True), StructField("A00600", DecimalType(20, 2), True), StructField("N00650", DecimalType(20, 2), True), StructField("A00650", DecimalType(20, 2), True), StructField("N00700", DecimalType(20, 2), True), StructField("A00700", DecimalType(20, 2), True), StructField("N00900", DecimalType(20, 2), True), StructField("A00900", DecimalType(20, 2), True), StructField("N01000", DecimalType(20, 2), True), StructField("A01000", DecimalType(20, 2), True), StructField("N01400", DecimalType(20, 2), True), StructField("A01400", DecimalType(20, 2), True), StructField("N01700", DecimalType(20, 2), True), StructField("A01700", DecimalType(20, 2), True), StructField("SCHF", DecimalType(20, 2), True), StructField("N02300", DecimalType(20, 2), True), StructField("A02300", DecimalType(20, 2), True), StructField("N02500", DecimalType(20, 2), True), StructField("A02500", DecimalType(20, 2), True), StructField("N26270", DecimalType(20, 2), True), StructField("A26270", DecimalType(20, 2), True), StructField("N02900", DecimalType(20, 2), True), StructField("A02900", DecimalType(20, 2), True), StructField("N03220", DecimalType(20, 2), True), StructField("A03220", DecimalType(20, 2), True), StructField("N03300", DecimalType(20, 2), True), StructField("A03300", DecimalType(20, 2), True), StructField("N03270", DecimalType(20, 2), True), StructField("A03270", DecimalType(20, 2), True), StructField("N03150", DecimalType(20, 2), True), StructField("A03150", DecimalType(20, 2), True), StructField("N03210", DecimalType(20, 2), True), StructField("A03210", DecimalType(20, 2), True), StructField("N03230", DecimalType(20, 2), True), StructField("A03230", DecimalType(20, 2), True), StructField("N03240", DecimalType(20, 2), True), StructField("A03240", DecimalType(20, 2), True), StructField("N04470", DecimalType(20, 2), True), StructField("A04470", DecimalType(20, 2), True), StructField("A00101", DecimalType(20, 2), True), StructField("N18425", DecimalType(20, 2), True), StructField("A18425", DecimalType(20, 2), True), StructField("N18450", DecimalType(20, 2), True), StructField("A18450", DecimalType(20, 2), True), StructField("N18500", DecimalType(20, 2), True), StructField("A18500", DecimalType(20, 2), True), StructField("N18300", DecimalType(20, 2), True), StructField("A18300", DecimalType(20, 2), True), StructField("N19300", DecimalType(20, 2), True), StructField("A19300", DecimalType(20, 2), True), StructField("N19700", DecimalType(20, 2), True), StructField("A19700", DecimalType(20, 2), True), StructField("N04800", DecimalType(20, 2), True), StructField("A04800", DecimalType(20, 2), True), StructField("N05800", DecimalType(20, 2), True), StructField("A05800", DecimalType(20, 2), True), StructField("N09600", DecimalType(20, 2), True), StructField("A09600", DecimalType(20, 2), True), StructField("N07100", DecimalType(20, 2), True), StructField("A07100", DecimalType(20, 2), True), StructField("N07300", DecimalType(20, 2), True), StructField("A07300", DecimalType(20, 2), True), StructField("N07180", DecimalType(20, 2), True), StructField("A07180", DecimalType(20, 2), True), StructField("N07230", DecimalType(20, 2), True), StructField("A07230", DecimalType(20, 2), True), StructField("N07240", DecimalType(20, 2), True), StructField("A07240", DecimalType(20, 2), True), StructField("N07220", DecimalType(20, 2), True), StructField("A07220", DecimalType(20, 2), True), StructField("N07260", DecimalType(20, 2), True), StructField("A07260", DecimalType(20, 2), True), StructField("N09400", DecimalType(20, 2), True), StructField("A09400", DecimalType(20, 2), True), StructField("N10600", DecimalType(20, 2), True), StructField("A10600", DecimalType(20, 2), True), StructField("N59660", DecimalType(20, 2), True), StructField("A59660", DecimalType(20, 2), True), StructField("N59720", DecimalType(20, 2), True), StructField("A59720", DecimalType(20, 2), True), StructField("N11070", DecimalType(20, 2), True), StructField("A11070", DecimalType(20, 2), True), StructField("N10960", DecimalType(20, 2), True), StructField("A10960", DecimalType(20, 2), True), StructField("N06500", DecimalType(20, 2), True), StructField("A06500", DecimalType(20, 2), True), StructField("N10300", DecimalType(20, 2), True), StructField("A10300", DecimalType(20, 2), True), StructField("N85330", DecimalType(20, 2), True), StructField("A85330", DecimalType(20, 2), True), StructField("N85300", DecimalType(20, 2), True), StructField("A85300", DecimalType(20, 2), True), StructField("N11901", DecimalType(20, 2), True), StructField("A11901", DecimalType(20, 2), True), StructField("N11902", DecimalType(20, 2), True), StructField("A11902", DecimalType(20, 2), True)
        ])
        )\
        .option("header", True)\
        .option("sep", ",")\
        .csv("dbfs:/databricks-datasets/data.gov/irs_zip_code_data/data-001/2013_soi_zipcode_agi.csv")
